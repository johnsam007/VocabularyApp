<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:AgeSmartVocabulary.ViewModels"
             x:Class="AgeSmartVocabulary.Views.HomePage"
             xmlns:System="clr-namespace:System;assembly=System.Runtime"
             x:DataType="viewmodels:HomeViewModel"
             Title="{Binding Title}"
             BackgroundColor="#F5F7FA">

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="20">

            <!-- Loading Indicator -->
            <ActivityIndicator IsRunning="{Binding IsLoading}"
                              IsVisible="{Binding IsLoading}"
                              Color="#3498DB"
                              HeightRequest="50" />

            <!-- No Word State -->
            <VerticalStackLayout IsVisible="{Binding CurrentWord, Converter={StaticResource IsNullConverter}}"
                     Padding="30"
                     Spacing="20"
                     VerticalOptions="Center"
                     HeightRequest="400">
                <Label Text="ðŸ˜•"
           FontSize="60"
           HorizontalTextAlignment="Center" />
                <Label Text="Unable to fetch word"
           FontSize="20"
           FontAttributes="Bold"
           TextColor="#2C3E50"
           HorizontalTextAlignment="Center" />
                <Label Text="Check your internet connection and try again"
           FontSize="14"
           TextColor="#7F8C8D"
           HorizontalTextAlignment="Center" />
                <Button Text="ðŸ”„ Try Again"
            Command="{Binding LoadTodayWordCommand}"
            BackgroundColor="#3498DB"
            TextColor="White"
            FontSize="16"
            CornerRadius="15"
            HeightRequest="50"
            Margin="0,20,0,0" />
            </VerticalStackLayout>

            <!-- Main Card -->
            <!-- Main Card -->
            <Frame IsVisible="{Binding CurrentWord, Converter={StaticResource IsNotNullConverter}}"
       BackgroundColor="White"
       CornerRadius="20"
       HasShadow="True"
       Padding="30">
                <VerticalStackLayout Spacing="15">

                    <!-- Date -->
                    <Label Text="{Binding Source={x:Static System:DateTime.Today}, StringFormat='{0:dddd, MMMM dd}'}"
                           FontSize="14"
                           TextColor="#95A5A6"
                           HorizontalTextAlignment="Center" />

                    <!-- Word -->
                    <Label Text="{Binding CurrentWord.Word}"
                           FontSize="42"
                           FontAttributes="Bold"
                           TextColor="#2C3E50"
                           HorizontalTextAlignment="Center" />

                    <!-- Phonetic -->
                    <Label Text="{Binding CurrentWord.Phonetic}"
                           FontSize="16"
                           TextColor="#7F8C8D"
                           HorizontalTextAlignment="Center"
                           IsVisible="{Binding CurrentWord.Phonetic, Converter={StaticResource StringNotEmptyConverter}}" />

                    <!-- Divider -->
                    <BoxView HeightRequest="1"
                            BackgroundColor="#ECF0F1"
                            Margin="0,10" />

                    <!-- Meaning -->
                    <Label Text="Meaning"
                           FontSize="14"
                           FontAttributes="Bold"
                           TextColor="#7F8C8D" />
                    <Label Text="{Binding CurrentWord.Meaning}"
                           FontSize="16"
                           TextColor="#2C3E50"
                           LineBreakMode="WordWrap" />

                    <!-- Example -->
                    <Label Text="Example"
                           FontSize="14"
                           FontAttributes="Bold"
                           TextColor="#7F8C8D"
                           Margin="0,10,0,0"
                           IsVisible="{Binding CurrentWord.Example, Converter={StaticResource StringNotEmptyConverter}}" />
                    <Label Text="{Binding CurrentWord.Example}"
                           FontSize="16"
                           TextColor="#34495E"
                           FontAttributes="Italic"
                           LineBreakMode="WordWrap"
                           IsVisible="{Binding CurrentWord.Example, Converter={StaticResource StringNotEmptyConverter}}" />

                </VerticalStackLayout>
            </Frame>

            <!-- Action Buttons -->
            <Grid ColumnDefinitions="*,*" ColumnSpacing="15"
                  IsVisible="{Binding IsLoading, Converter={StaticResource InvertedBoolConverter}}">

                <Button Grid.Column="0"
                        Text="âœ“ Known"
                        Command="{Binding MarkAsKnownCommand}"
                        BackgroundColor="#27AE60"
                        TextColor="White"
                        FontSize="16"
                        FontAttributes="Bold"
                        CornerRadius="15"
                        HeightRequest="50" />

                <Button Grid.Column="1"
                        Text="â†» Revise"
                        Command="{Binding MarkAsReviseCommand}"
                        BackgroundColor="#E74C3C"
                        TextColor="White"
                        FontSize="16"
                        FontAttributes="Bold"
                        CornerRadius="15"
                        HeightRequest="50" />
            </Grid>

            <!-- Refresh Button -->
            <Button Text="ðŸ”„ Get New Word"
                    Command="{Binding LoadTodayWordCommand}"
                    BackgroundColor="#3498DB"
                    TextColor="White"
                    FontSize="16"
                    CornerRadius="15"
                    HeightRequest="50"
                    IsVisible="{Binding IsLoading, Converter={StaticResource InvertedBoolConverter}}" />

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>